%! TEX program = xelatex
\documentclass[Chinese,English,French,puretext]{simplivre}

\CreateTheorem{definition}<highest>
\CreateTheorem{theorem}<highest>

\linenumbers % 开启行号

%%================================
%% 引入工具集
%%================================
\usepackage{ProjLib}
\usepackage{longtable}  % breakable tables
\usepackage{hologo}     % more TeX logo

\UseLanguage{Chinese}

%%================================
%% 排版代码
%%================================
\usepackage{listings}
\definecolor{maintheme}{RGB}{70,130,180}
\definecolor{forestgreen}{RGB}{21,122,81}
\definecolor{lightergray}{gray}{0.99}
\lstset{language=[LaTeX]TeX,
    keywordstyle=\color{maintheme},
    basicstyle=\ttfamily,
    commentstyle=\color{forestgreen}\ttfamily,
    stringstyle=\rmfamily,
    showstringspaces=false,
    breaklines=true,
    frame=lines,
    backgroundcolor=\color{lightergray},
    flexiblecolumns=true,
    escapeinside={(*}{*)},
    % numbers=left,
    numberstyle=\scriptsize, stepnumber=1, numbersep=5pt,
    firstnumber=last,
} 
\providecommand{\meta}[1]{$\langle${\normalfont\itshape#1}$\rangle$}
\lstset{moretexcs=%
    {linenumbers,nolinenumbers,part,chapter,section,subsection,subsubsection,href,
    color,NameTheorem,CreateTheorem,proofideanameCN,cref,dnf,needgraph,UseLanguage,UseOtherLanguage,AddLanguageSetting,maketitle,address,curraddr,email,keywords,subjclass,thanks,dedicatory,PLdate,ProjLib,parttext,qedhere
    }
}
\lstnewenvironment{code}% 
{\LocallyStopLineNumbers%
\setkeys{lst}{columns=fullflexible,keepspaces=true}%
}
{\ResumeLineNumbers}

%%================================
%% tip
%%================================
\usepackage[many]{tcolorbox}
\newenvironment{tip}[1][提示]{%
    \LocallyStopLineNumbers%
    \begin{tcolorbox}[breakable,
        enhanced,
        width = \textwidth,
        colback = white, colbacktitle = paper,
        colframe = gray!50, boxrule=0.2mm,
        coltitle = black,
        fonttitle = \sffamily,
        attach boxed title to top left = {yshift=-\tcboxedtitleheight/2,  xshift=\tcboxedtitlewidth/4},
        boxed title style = {boxrule=0pt, colframe=paper},
        before skip = 0.3cm,
        after skip = 0.3cm,
        top = 3mm,
        bottom = 3mm,
        title={\sffamily #1}]%
}{\end{tcolorbox}\ResumeLineNumbers}

%%================================
%% 名称
%%================================
\providecommand{\minimalist}{\textsf{minimalist}}
\providecommand{\minimart}{\textsf{minimart}}
\providecommand{\minimbook}{\textsf{minimbook}}
\providecommand{\einfart}{\textsf{einfart}}
\providecommand{\simplivre}{\textsf{simplivre}}

\usetikzlibrary{calc}

\usepackage{blindtext}

%%================================
%% 正文
%%================================
\begin{document}

% \title{\simplivre{}，以极简主义风格排版你的图书\thanks{对应版本. \texttt{\simplivre{} 2021/06/07}}}
% \author{许锦文}
% \date{2021年6月，北京}

% \maketitle

\frontmatter

\begin{titlepage} % Suppresses displaying the page number on the title page and the subsequent page counts as page 1
\begin{tikzpicture}[overlay,remember picture]
    \fill [cyan!90!black] ($(current page.south west)+(0,7)$) rectangle ($(current page.north west)+(21,-7)$);
    \fill [yellow] (current page.south west) rectangle ($(current page.north west)+(3,0)$);
    \node[text width=10cm] at ($(current page.north west)+(8.5,-6)$) {\huge\ProjLib};
    \node[text width=6cm,text height=3.5cm,scale=2.5] at ($(current page.north west)+(11,-9)$) {\textcolor{white}{\sffamily\simplivre{}\\[5pt]\footnotesize\hspace*{-.05em}以极简主义风格排版你的图书\\[10pt]\tiny 对应版本. \texttt{\simplivre{} 2021/07/05}}};
    \node at ($(current page.south)+(1.5,3)$) {\fontsize{16pt}{0pt}\selectfont\textcolor{gray}{许锦文}};
    \node at ($(current page.south)+(1.5,2)$) {\fontsize{12pt}{0pt}\selectfont\textcolor{gray}{2021年7月，北京}};
\end{tikzpicture}%
\end{titlepage}%
\cleardoublepage%

\chapter*{前言}

\simplivre{} 是 \minimalist{} 文档类系列的成员之一，其名称取自于法文的 simple (“简约”)，以及 livre (“书”)，由二者组合而成。整个 \minimalist{} 系列包含用于排版文章的 \minimart{}、\einfart{} 以及用于排版书的 \minimbook{}、\simplivre{}。我设计这一系列的初衷是为了撰写草稿与笔记，使之看上去简朴而不简陋。

\simplivre{} 支持英语、法语、德语、意大利语、葡萄牙语、巴西葡萄牙语、西班牙语、简体中文、繁体中文、日文、俄文，并且同一篇文档中这些语言可以很好地协调。由于采用了自定义字体，需要用 \hologo{XeLaTeX} 或 \hologo{LuaLaTeX} 引擎进行编译。

这篇说明文档即是用 \simplivre{} 排版的，你可以把它看作一份简短的说明与演示。

\bigskip
\begin{tip}
    多语言支持、定理类环境、未完成标记等功能是由 \ProjLib{} 工具箱提供的，这里只给出了将其与本文档类搭配使用的要点。如需获取更详细的信息，可以参阅 \ProjLib{} 的说明文档。
\end{tip}

\tableofcontents

\mainmatter

\part{说明}
\parttext{可以通过 \lstinline|\\parttext|\meta{text} 在这里添加一些说明}

\chapter{初始化}

\section{如何载入}

只需要在第一行写：

\begin{code}
  \documentclass{simplivre}
\end{code}

即可使用 \simplivre{} 文档类。

\begin{tip}[请注意]
    要使用 \hologo{XeLaTeX} 或 \hologo{LuaLaTeX} 引擎才能编译。
\end{tip}

\section{选项}

\simplivre{} 文档类有下面几个选项：

\begin{itemize}
    \item 语言选项 \texttt{EN} / \texttt{english} / \texttt{English}、\texttt{FR} / \texttt{french} / \texttt{French}，等等
        \begin{itemize}
            \item 具体选项名称可参见下一节的 \meta{language name}。第一个指定的语言将作为默认语言。
        \end{itemize}
    \item \texttt{draft} 或 \texttt{fast}
        \begin{itemize}
            \item 你可以使用选项 \verb|fast| 来启用快速但略微粗糙的样式，主要区别是：
            \begin{itemize}
                \item 使用较为简单的数学字体设置；
                \item 不启用超链接；
                \item 启用 \ProjLib{} 工具箱的快速模式。
            \end{itemize}
        \end{itemize}
\begin{tip}
    在文章的撰写阶段，建议使用 \verb|fast| 选项以加快编译速度，改善写作时的流畅度。使用 \verb|fast| 模式时会有“DRAFT”字样的水印，以提示目前处于草稿阶段。
\end{tip}
    \item \texttt{a4paper} 或 \texttt{b5paper}
        \begin{itemize}
            \item 可选的纸张大小。默认的纸张大小为 7in $\times$ 10in。
        \end{itemize}
    \clearpage
    \item \texttt{palatino}、\texttt{times}、\texttt{garamond}、\texttt{biolinum} ~$|$~ \texttt{useosf}
        \begin{itemize}
            \item 字体选项。顾名思义，会加载相应名称的字体。
            \item \texttt{useosf} 选项用来启用“旧式”数字。
        \end{itemize}
    \item \texttt{allowbf}
        \begin{itemize}
            \item 允许加粗。启用这一选项时，题目、各级标题、定理类环境名称会被加粗。
        \end{itemize}
    \item \texttt{classical}
        \begin{itemize}
            \item 经典模式。启用这一选项时，样式会变得更加中规中矩：段落呈首行缩进样式、各类下划线减少、标题样式改变、定理类环境的样式也会更贴近常见的设置。
        \end{itemize}
\begin{tip}
    如果你喜欢更加传统的样式，\texttt{allowbf} + \texttt{classical} 是一个不错的搭配。
\end{tip}
        \item \texttt{useindent}
        \begin{itemize}
            \item 采用段首缩进而不是段间间距。
        \end{itemize}
    \item \texttt{runin}
        \begin{itemize}
            \item \lstinline|\subsubsection| 采用 ``runin'' 风格。
        \end{itemize}
    \item \texttt{puretext} or \texttt{nothms}
        \begin{itemize}
            \item 纯文本模式，不加载定理类环境。
        \end{itemize}
    \item \texttt{nothmnum}
        \begin{itemize}
            \item 定理类环境不编号。
        \end{itemize}
\end{itemize}

\bigskip
另外，排版图书时常用的 \texttt{oneside}、\texttt{twoside} 选项也是可以使用的。默认采用双页排版。

\chapter{关于默认字体}
\simplivre{} 默认使用 Palatino Linotype 作为英文字体，方正悠宋、悠黑GBK作为中文字体，并部分使用了 Neo Euler 作为数学字体。其中，Neo Euler可以在 \url{https://github.com/khaledhosny/euler-otf} 下载。其他字体不是免费字体，需要自行购买使用。可以在方正字库网站查询详细资料：\url{https://www.foundertype.com}。

\begin{tip}[字体演示]
    \begin{itemize}
        \item English main font. \textsf{English sans serif font}. \texttt{English typewriter font}.
        \item 中文主要字体，\textsf{中文无衬线字体}
        \item 数学示例： \( \alpha, \beta, \gamma, \delta, 1,2,3,4, a,b,c,d \), \[\mathrm{li}(x)\coloneqq \int_2^{\infty} \frac{1}{\log t}\,\mathrm{d}t \]
    \end{itemize}
\end{tip}

\bigskip
在没有安装相应的字体时，将采用TeX Live中自带的字体来代替，效果可能会有所折扣。


\chapter{使用说明}

\vspace{-\baselineskip}

接下来介绍的许多功能是由 \ProjLib{} 工具箱提供的。这里只介绍了基本使用方法，更多细节可以直接参阅其用户文档。

\section{语言设置}

\simplivre{} 提供了多语言支持，包括英语、法语、德语、意大利语、葡萄牙语、巴西葡萄牙语、西班牙语、简体中文、繁体中文、日文、俄文。可以通过下列命令来选定语言：
\begin{itemize}
    \item \lstinline|\UseLanguage{|\meta{language name}\lstinline|}|，用于指定语言，在其后将使用对应的语言设定。
    \begin{itemize}
        \item 既可以用于导言部分，也可以用于正文部分。在不指定语言时，默认选定 “English”。
    \end{itemize}
    \item \lstinline|\UseOtherLanguage{|\meta{language name}\lstinline|}{|\meta{content}\lstinline|}|，用指定的语言的设定排版 \meta{content}。
    \begin{itemize}
        \item 相比较 \lstinline|\UseLanguage|，它不会对行距进行修改，因此中西文字混排时能够保持行距稳定。
    \end{itemize}
\end{itemize}

\meta{language name} 有下列选择 (不区分大小写，如 \texttt{French} 或 \texttt{french} 均可)：
\begin{itemize}
    \item 简体中文：\texttt{CN}、\texttt{Chinese}、\texttt{SChinese} 或 \texttt{SimplifiedChinese}
    \item 繁体中文：\texttt{TC}、\texttt{TChinese} 或 \texttt{TraditionalChinese}
    \item 英文：\texttt{EN} 或 \texttt{English}
    \item 法文：\texttt{FR} 或 \texttt{French}
    \item 德文：\texttt{DE}、\texttt{German} 或 \texttt{ngerman}
    \item 意大利语：\texttt{IT} 或 \texttt{Italian}
    \item 葡萄牙语：\texttt{PT} 或 \texttt{Portuguese}
    \item 巴西葡萄牙语：\texttt{BR} 或 \texttt{Brazilian}
    \item 西班牙语：\texttt{ES} 或 \texttt{Spanish}
    \item 日文：\texttt{JP} 或 \texttt{Japanese}
    \item 俄文：\texttt{RU} 或 \texttt{Russian}
\end{itemize}

另外，还可以通过下面的方式来填加相应语言的设置：
\begin{itemize}
    \item \lstinline|\AddLanguageSetting{|\meta{settings}\lstinline|}|
    \begin{itemize}
        \item 向所有支持的语言增加设置 \meta{settings}。
    \end{itemize}
    \item \lstinline|\AddLanguageSetting(|\meta{language name}\lstinline|){|\meta{settings}\lstinline|}|
    \begin{itemize}
        \item 向指定的语言 \meta{language name} 增加设置 \meta{settings}。
    \end{itemize}
\end{itemize}
例如，\lstinline|\AddLanguageSetting(German){\color{orange}}| 可以让所有德语以橙色显示（当然，还需要再加上 \lstinline|\AddLanguageSetting{\color{black}}| 来修正其他语言的颜色）。


\section{定理类环境及其引用}

定义、定理等环境已经被预定义，可以直接使用。

具体来说，预设的定理类环境包括：
\texttt{assumption}、\texttt{axiom}、\texttt{conjecture}、\texttt{convention}、\texttt{corollary}、\texttt{definition}、\texttt{definition-proposition}、\texttt{definition-theorem}、\texttt{example}、\texttt{exercise}、\texttt{fact}、\texttt{hypothesis}、\texttt{lemma}、\texttt{notation}、\texttt{observation}、\texttt{problem}、\texttt{property}、\texttt{proposition}、\texttt{question}、\texttt{remark}、\texttt{theorem}，以及相应的带有星号 \lstinline|*| 的无编号版本。

在引用定理类环境时，建议使用智能引用 \lstinline|\cref{|\meta{label}\lstinline|}|。这样就不必每次都写上相应环境的名称了。

\begin{tip}[例子]
\begin{code}
  \begin{definition}[奇异物品] \label{def: strange} ...
\end{code}
将会生成
\begin{definition}[奇异物品]\label{def: strange}
    这是奇异物品的定义。定理类环境的前后有一行左右的间距。在定义结束的时候会有一个符号来标记。
\end{definition}

\lstinline|\cref{def: strange}| 会显示为：\cref{def: strange}。

使用 \lstinline|\UseLanguage{English}| 后，定理会显示为：

\UseLanguage{English}
\begin{theorem}[Useless]\label{thm}
    A theorem in English.
\end{theorem}

默认情况下，引用时，定理的名称总是与定理所在区域的语言匹配，例如，上面的定义在现在的英文模式下依然显示为中文：\cref{def: strange} 和 \cref{thm}。如果在引用时想让定理的名称与当前语境相匹配，可以在全局选项中加入 \texttt{regionalref}。
\end{tip}

\UseLanguage{Chinese}


\section{定义新的定理型环境}

若需要定义新的定理类环境，首先要定义这个环境在所用语言下的名称：
% \vspace{-.15\baselineskip}%
\begin{itemize}
    \item \lstinline|\NameTheorem[|\meta{language name}\lstinline|]{|\meta{name of environment}\lstinline|}{|\meta{name string}\lstinline|}|
\end{itemize}
% \vspace{-.15\baselineskip}%
其中，\meta{language name} 可参阅关于语言设置的小节。当不指定 \meta{language name}时，则会将该名称设置为所有支持语言下的名称。另外，带星号与不带星号的同名环境共用一个名称，因此 \lstinline|\NameTheorem{envname*}{...}| 与 \lstinline|\NameTheorem{envname}{...}| 效果相同。

然后用下面五种方式之一定义这一环境：
\begin{itemize}
    \item \lstinline|\CreateTheorem*{|\meta{name of environment}\lstinline|}|
        \begin{itemize}
            \item 定义不编号的环境 \meta{name of environment}
        \end{itemize}
    \item \lstinline|\CreateTheorem{|\meta{name of environment}\lstinline|}|
        \begin{itemize}
            \item 定义编号环境 \meta{name of environment}，按顺序编号
        \end{itemize}
    \item \lstinline|\CreateTheorem{|\meta{name of environment}\lstinline|}[|\meta{numbered like}\lstinline|]|
        \begin{itemize}
            \item 定义编号环境 \meta{name of environment}，与 \meta{numbered like} 计数器共用编号
        \end{itemize}
    \item \lstinline|\CreateTheorem{|\meta{name of environment}\lstinline|}<|\meta{numbered within}\lstinline|>|
        \begin{itemize}
            \item 定义编号环境 \meta{name of environment}，在 \meta{numbered within} 计数器内编号
        \end{itemize}
    \item \lstinline|\CreateTheorem{|\meta{name of environment}\lstinline|}(|\meta{existed environment}\lstinline|)|\\
    \lstinline|\CreateTheorem*{|\meta{name of environment}\lstinline|}(|\meta{existed environment}\lstinline|)|
        \begin{itemize}
            \item 将 \meta{name of environment} 与 \meta{existed environment} 或 \meta{existed environment}\lstinline|*| 等同。
            \item 这种方式通常在两种情况下比较有用：
                \begin{enumerate}
                    \item 希望定义更简洁的名称。例如，使用 \lstinline|\CreateTheorem{thm}(theorem)|，便可以直接用名称 \texttt{thm} 来撰写定理。
                    \item 希望去除某些环境的编号。例如，使用 \lstinline|\CreateTheorem{remark}(remark*)|，便可以去除 \texttt{remark} 环境的编号。
                \end{enumerate}
        \end{itemize}
\end{itemize}

\begin{tip}
    其内部使用了 \textsf{amsthm}，因此传统的 \texttt{theoremstyle} 对其也是适用的，只需在相关定义前标明即可。
\end{tip}

% \def\proofideanameCN{思路}
\NameTheorem[CN]{proofidea}{思路}
\CreateTheorem*{proofidea*}
\CreateTheorem{proofidea}<section>

\bigskip
下面提供一个例子。这三行代码：

\begin{code}
  \NameTheorem[CN]{proofidea}{思路}
  \CreateTheorem*{proofidea*}
  \CreateTheorem{proofidea}<section>
\end{code}

可以分别定义不编号的环境 \lstinline|proofidea*| 和编号的环境 \lstinline|proofidea| (在 section 内编号)，它们支持在简体中文语境中使用，效果如下所示:

\begin{proofidea*}
    \lstinline|proofidea*| 环境。
\end{proofidea*}

\begin{proofidea}
    \lstinline|proofidea| 环境。
\end{proofidea}

\section{未完成标记}

你可以通过 \lstinline|\dnf| 来标记尚未完成的部分。例如：
\begin{itemize}
    \item \lstinline|\dnf| 或 \lstinline|\dnf<...>|。效果为：\dnf~或 \dnf<...>。\\其提示文字与当前语言相对应，例如，在法语模式下将会显示为 \UseOtherLanguage{French}{\dnf}。
\end{itemize}

类似的，还有 \lstinline|\needgraph| ：
\begin{itemize}
    \item \lstinline|\needgraph| 或 \lstinline|\needgraph<...>|。效果为：\needgraph~或 \needgraph<...>其提示文字与当前语言相对应，例如，在法语模式下将会显示为 \UseOtherLanguage{French}{\needgraph}
\end{itemize}


% \section{关于文章标题、摘要与关键词}

% % 由于引入了 \ProjLib{} 工具箱的 \textsf{PJLamssim} 组件，
% \simplivre{} 同时具有标准文档类与\AmS{} 文档类的一些特性。

% 因此，文章的标题部分既可以按照标准文档类 \textsf{article} 的写法来写：

% \begin{code}
%   \title{(*\meta{title}*)}
%   \author{(*\meta{author}*)}
%   \date{(*\meta{date}*)}
%   \maketitle
%   \begin{abstract}
%       (*\meta{abstract}*)
%   \end{abstract}
%   \begin{keyword}
%       (*\meta{keywords}*)
%   \end{keyword}
% \end{code}

% 也可以按照 \AmS{} 文档类的方式来写：

% \begin{code}
%   \title{(*\meta{title}*)}
%   \author{(*\meta{author}*)}
%   \address{(*\meta{address}*)}
%   \email{(*\meta{email}*)}
%   \date{(*\meta{date}*)}
%   \keywords{(*\meta{keywords}*)}
%   \subjclass{(*\meta{subjclass}*)}
%   \begin{abstract}
%       (*\meta{abstract}*)
%   \end{abstract}
%   \maketitle
% \end{code}

% 作者信息可以包含多组，输入方式为：

% \begin{code}
%   \author{(*\meta{author 1}*)}
%   \address{(*\meta{address 1}*)}
%   \email{(*\meta{email 1}*)}
%   \author{(*\meta{author 2}*)}
%   \address{(*\meta{address 2}*)}
%   \email{(*\meta{email 2}*)}
%   ...
% \end{code}

% 其中 \lstinline|\address|、\lstinline|\curraddr|、\lstinline|\email| 的相互顺序是不重要的。

\section{关于行号}
行号可以随时开启和关闭。\lstinline|\linenumbers| 用来开启行号，\lstinline|\nolinenumbers| 用来关闭行号。标题、目录、索引等位置为了美观，不进行编号。

\section{关于标题中的脚注}
在 \lstinline|\section| 或 \lstinline|\subsection| 中，如果想使用脚注，只能：
\begin{itemize}
    \item 先写 \lstinline|\mbox{\protect\footnotemark}|，
    \item 再在后面用 \lstinline|\footnotetext{...}|。
\end{itemize}
这是标题使用下划线装饰之后带来的一个缺点。

\section{关于QED符号}
由于定理类环境中的字体和正文字体是一样的，为了方便看出定理类环境在哪里结束，在其结尾处放置了一个空心的QED符号。然而，如果你的定理是由公式或者列表结尾的，这个符号就无法自动地放在正确的位置。这时，你需要手动在公式或列表最后一个条目的后面加上 \lstinline|\qedhere|，以让QED符号显示到这一行的最后。


\section{目前存在的问题}

\begin{itemize}[itemsep=.6em]
    \item 对于字体的设置仍然不够完善。
    \item 由于很多核心功能建立在 \ProjLib{} 工具箱的基础上，因此 \simplivre{} 自然继承了其所有问题。详情可以参阅 \ProjLib{} 用户文档的“目前存在的问题”这一小节。
    \item 错误处理功能不完善，在出现一些问题时没有相应的错误提示。
    \item 代码中仍有许多可优化之处。
\end{itemize}



\UseLanguage{English}

\part{演示}

\chapter{文档示例}

\vspace*{-1.5\baselineskip}

\section{标准文档类写法}

如果想采用标准文档类中的写法，可以参考下面的例子：

\begin{code}
\documentclass{simplivre}
\usepackage{ProjLib} % Load ProjLib toolkit

\UseLanguage{French} % Use French from here

\begin{document}

\title{Le Titre}
\author{Auteur}
\date{\PLdate{2022-04-01}}

\maketitle

\chapter{Un théorème}

%% Theorem-like environments can be used directly
\begin{theorem}\label{thm:abc}
    Ceci est un théorème.
\end{theorem}

Référence du théorème: \cref{thm:abc} 
    % It is recommended to use clever reference

\end{document}
\end{code}

如果以后想切换到标准文档类，只需要将前两行换为：

\begin{code}
\documentclass{book}
\usepackage[a4paper,margin=1in]{geometry}
\usepackage[hidelinks]{hyperref}
\usepackage[palatino]{ProjLib} % Load ProjLib toolkit
\end{code}


% \clearpage
\section{\texorpdfstring{\AmS{}}{AMS} 文档类写法}

如果日后有意切换到期刊模版，想采用 \AmS{} 文档类中的写法，可以参考下面的例子：

\begin{code}
\documentclass{simplivre}
\usepackage{ProjLib} % Load ProjLib toolkit

\UseLanguage{French} % Use French from here

\begin{document}

\title{Le Titre}
\author{Auteur 1}
\address{Adresse 1}
\email{\href{Courriel 1}{Courriel 1}}
\author{Auteur 1}
\address{Adresse 1}
\email{\href{Courriel 2}{Courriel 2}}
\date{\PLdate{2022-04-01}}
\subjclass{*****}
\keywords{...}

\maketitle

\section{Première section}

%% Theorem-like environments can be used directly
\begin{theorem}\label{thm:abc}
    Ceci est un théorème.
\end{theorem}

Référence du théorème: \cref{thm:abc} 
    % It is recommended to use clever reference

\end{document}
\end{code}

这样，若想切换到 \AmS{} 文档类，只需要将前两行换为：

\begin{code}
\documentclass{amsbook}
\usepackage[a4paper,margin=1in]{geometry}
\usepackage[hidelinks]{hyperref}
\usepackage[palatino]{ProjLib} % Load ProjLib toolkit
\end{code}

\blinddocument

\end{document}
